
@{
    ViewData["Title"] = "Formlist";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";

    var jwtToken = Context.Session.GetString("JWTToken");
}
<style>
    body {
        background-color: #f8f9fa;
    }

    .card {
        border-radius: 10px;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
</style>

<h2 class="mb-4 text-center">📋 Available Exam Forms</h2>
<h2 class="mb-4 text-end"><a href="/Admin/forms">Create Exam Form</h2>

<div id="formList" class="row g-3 justify-content-center">

</div>



<script>
    document.addEventListener("DOMContentLoaded", async () => {
        const formListDiv = document.getElementById("formList");
        const token = '@jwtToken'.trim();

        if (!token) {
            formListDiv.innerHTML = `
              <div class="alert alert-warning text-center">No token found. Please log in again.</div>
            `;
            return;
        }

        try {
            const response = await fetch("https://localhost:7267/api/Form/Formlist", {
                method: "GET",
                headers: {
                    "Authorization": `Bearer ${token}`,
                    "Content-Type": "application/json"
                }
            });

            const result = await response.json();
            console.log(result);

            if (result.success && Array.isArray(result.data)) {
                formListDiv.innerHTML = result.data.map(form => `
                <div class="col-md-4">
                  <div class="card h-100 shadow-sm">
                    <div class="card-body">
                      <h5 class="card-title text-primary">${form.title}</h5>
                      <p class="card-text">${form.description}</p>
                      <p><strong>Fee:</strong> ₹${form.fee.toFixed(2)}</p>
                           <a href="/Admin/PreviewForm/${form.id}" class="btn btn-success w-100"> Preview Form

    </a>  </div>
                  </div>
                </div>
              `).join("");


            } else {
                formListDiv.innerHTML = `
                <div class="alert alert-danger text-center">No forms found.</div>
              `;
            }
        } catch (err) {
            console.error(err);
            formListDiv.innerHTML = `
              <div class="alert alert-danger text-center">
                Failed to fetch forms. Please try again later.
              </div>
            `;
        }
    });
</script>

